---
title: "Michigan Athletics CO2 Emissions"
author: "Frida Gomam"
date: 2022-11-22T21:13:14-05:00
categories: ["R"]
tags: ["R Markdown", "plot", "carbon emissions"]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

# Data Cleaning
This page contains a few small data visualizations that I created for CO2 emissions generated by UM Athletics facilities. The data was obtained from the Office of Campus Sustainability and you can see it portrayed in a much better (?) way on their website: <https://ocs.umich.edu/resources/sustainability-data/building-energy-data/> 

Before I could create the visualizations I had to clean up the data a bit and organize it the way I wanted.

```{r data exploration, echo = TRUE, warnings = FALSE}

library(plyr)
library(dplyr)
library(tidyr)

d <- read.csv("/Users/zane/R/SafeWebsite/Copy of GGE (MTCO2)_Full Data_data - Data to be exported for R (2) copy.csv")

d$abrev[d$Bname == "ALUMNI FIELD"] <- "Alumni Field"
d$abrev[d$Bname == "ATH CREW BOATHOUSE FACILITY"] <- "ATH Boathouse"
d$abrev[d$Bname == "BAHNA WRESTLING  CENTER"] <- "Wrestling"
d$abrev[d$Bname == "CRISLER ARENA"] <- "Crisler"
d$abrev[d$Bname == "CANHAM DONALD B NATATORIUM"] <- "Natatorium"
d$abrev[d$Bname == "FIELD HOCKEY COMPLEX"] <- "Field Hockey"
d$abrev[d$Bname == "FISHER RAY BASEBALL STADIUM"] <- "Baseball Stadium"
d$abrev[d$Bname == "GLICK AL FIELD HOUSE"] <- "Al Glick FH"
d$abrev[d$Bname == "HARTWIG MARIE DOROTHY ADMINISTRATION BUILDING"] <- "Admin Building"
d$abrev[d$Bname == "INDOOR TRACK BUILDING"] <- "Indoor Track"
d$abrev[d$Bname == "INTERCOLLEGIATE SOCCER STADIUM"] <- "Soccer"
d$abrev[d$Bname == "KEEN CLIFFORD P ARENA"] <- "Cliff Keen"
d$abrev[d$Bname == "MICHIGAN STADIUM COMPLEX"] <- "Big House"
d$abrev[d$Bname == "OOSTERBAAN BENNIE FIELD HOUSE"] <- "Oosterbaan FH"
d$abrev[d$Bname == "RADRICK FARMS CARETAKERS HOUSE"] <- "RF Caretakers House"
d$abrev[d$Bname == "RADRICK FARMS GOLF CLUBHOUSE"] <- "RF Clubhouse"
d$abrev[d$Bname == "ROSS STEPHEN M ACADEMIC CENTER"] <- "Academic Center"
d$abrev[d$Bname == "SCHEMBECHLER GLENN E HALL"] <- "Schembechler Hall"
d$abrev[d$Bname == "SHEPHERD WOMENS GYMNASTIC"] <- "Womens Gymnastic"
d$abrev[d$Bname == "TISCH PRESTON ROBERT TENNIS BLDG"] <- "Tennis"
d$abrev[d$Bname == "WEIDENBACH JOHN P HALL"] <- "Weidenbach Hall"
d$abrev[d$Bname == "WEISFELD FAMILY GOLF CENTER"] <- "Golf Center"
d$abrev[d$Bname == "WEISFELD FAMILY GOLF CENTER"] <- "Golf Center"

by_id <- ddply(d, .(Bname, Fiscal.Year, Utility.Type, abrev), 
               summarize, MTCO2 = sum(MTCO2), bldg.sqft = max(bldg.sqft))


df2<-by_id[!(by_id$Fiscal.Year==2006 | by_id$Fiscal.Year==2007 | by_id$Fiscal.Year==2008 |
             by_id$Fiscal.Year==2009 | by_id$Fiscal.Year==2010 | by_id$Fiscal.Year==2011 |
             by_id$Fiscal.Year==2012 | by_id$Fiscal.Year==2013),]

dfscope2 <- df2 %>% filter(Utility.Type == "Electric" | Utility.Type == "Steam")

dfscope2$kgCO2sqft <- (dfscope2$MTCO2*1000)/dfscope2$bldg.sqft

d2022 <- dfscope2 %>% filter(Fiscal.Year == 2022)

scope2 <- ddply(d2022, .(Bname, Fiscal.Year, abrev), 
               summarize, MTCO2 = sum(MTCO2), bldg.sqft = max(bldg.sqft))

```

# Visualizations

I created a visualization for all of 2022's emissions data associated with their scope 2 emissions. Scope 2 emissions are emissions associated with purchased electricity, steam, heating and cooling. Most buildings will only purchase electricity, and will generate their own heating, through natural gas furnace or electric heater. A few buidlings on campus purchase steam as the graph will show you.


```{r bar graph, echo = FALSE}
library(ggplot2)

ggplot(scope2, aes(x=reorder(abrev, -MTCO2), y=MTCO2)) +
  geom_bar(stat = "identity") +
  labs(title="Total CO2 Emissions from Scope 2 during 2022",
        x ="Facilities", y = "MTCO2") + 
  theme_bw() +
  theme(axis.text.x = element_text(angle = 50, hjust=1), 
        plot.margin = margin(1, 1, 1, 1, "cm"))

ggplot(d2022, aes(fill= factor(Utility.Type, levels=c("Steam", "Electric")), 
                 x=reorder(abrev, -kgCO2sqft, sum), 
                 y=kgCO2sqft)) +
  geom_bar(position="stack",stat = "identity") +
  labs(title="CO2 Emissions from Scope 2 per Square Foot during 2022",
        x ="Facilities", y = "kg CO2 per sq ft") +
  theme(axis.text.x = element_text(angle = 50, hjust=1), 
        plot.margin = margin(1, 1, 1, 1, "cm")) +
  guides(fill = guide_legend(title = "Utility"))

```
